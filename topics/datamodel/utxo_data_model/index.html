
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../transaction_data_model/">
      
      
        <link rel="next" href="../../kafka/kafka/">
      
      
        
      
      
      <link rel="icon" href="../../architecture/img/bsvblockchain_blue_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>UTXO Data Model - Teranode</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../overrides/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#teranode-data-model-utxo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Teranode" class="md-header__button md-logo" aria-label="Teranode" data-md-component="logo">
      
  <img src="../../architecture/img/bsvblockchain_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Teranode
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UTXO Data Model
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorials/developers/forkAndPullRequestGuidelines/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../howto/locallyRunningServices/" class="md-tabs__link">
          
  
  
  How-To Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../teranodeIntro/" class="md-tabs__link">
          
  
  
  Key Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../references/projectStructure/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Teranode" class="md-nav__button md-logo" aria-label="Teranode" data-md-component="logo">
      
  <img src="../../architecture/img/bsvblockchain_logo.svg" alt="logo">

    </a>
    Teranode
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/developers/forkAndPullRequestGuidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fork and Pull Request Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/developers/developerSetup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/miners/minersGettingStarted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Miners Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    How-To Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/locallyRunningServices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running Services Locally
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/howToRemoteDebugTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging Teranode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/generatingProtobuf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating Protobuf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/addingNewProtobufServices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding Protobuf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/configuringGrpcLogging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring gRPC Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/runningTests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running Tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/automatedTestingHowTo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/chain-integrity-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chain Integrity Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/makefile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Makefile Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/bugReporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bug Reporting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/developersHowToTeranodeCLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer's Guide to Teranode-CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12" >
        
          
          <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Miners
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Miners
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_1" >
        
          
          <label class="md-nav__link" for="__nav_3_12_1" id="__nav_3_12_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToInstallation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToInstallation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToInstallationDeprecated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deprecated
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_2" >
        
          
          <label class="md-nav__link" for="__nav_3_12_2" id="__nav_3_12_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToConfigureTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToConfigureTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToAerospikeTuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aerospike Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithAssetServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Server Interaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithFSM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FSM Interaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithRPCServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RPC Server Interaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_3" >
        
          
          <label class="md-nav__link" for="__nav_3_12_3" id="__nav_3_12_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Start/Stop
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Start/Stop
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToStopStartDockerTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToStopStartKubernetesTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_4" >
        
          
          <label class="md-nav__link" for="__nav_3_12_4" id="__nav_3_12_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Updating Teranode
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Updating Teranode
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersUpdatingTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersUpdatingTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_5" >
        
          
          <label class="md-nav__link" for="__nav_3_12_5" id="__nav_3_12_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security Best Practices
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security Best Practices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersSecurityBestPractices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersSecurityBestPractices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_6" >
        
          
          <label class="md-nav__link" for="__nav_3_12_6" id="__nav_3_12_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Troubleshooting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToTroubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToTroubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_7" >
        
          
          <label class="md-nav__link" for="__nav_3_12_7" id="__nav_3_12_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reset Teranode
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reset Teranode
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToResetTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToResetTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_8" >
        
          
          <label class="md-nav__link" for="__nav_3_12_8" id="__nav_3_12_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Sync the Node
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sync the Node
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToSyncTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToSyncTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_9" >
        
          
          <label class="md-nav__link" for="__nav_3_12_9" id="__nav_3_12_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToBackup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup Teranode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToCPUMiner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CPU Mining Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToTeranodeCLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Teranode CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersManagingDiskSpace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing Disk Space
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToUseListenMode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using Listen Mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Key Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Key Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teranodeIntro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Teranode Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-overall-system-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-architecture-brief/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Brief
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-microservices-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microservices Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transactionLifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transaction Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/stateManagement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../state-machine.diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State Machine Diagram
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/understandingDoubleSpends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding Double Spends
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technologyStack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Technology Stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../understandingTheTestingFramework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding the Testing Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functionalRequirementTests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Requirement Tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/two_phase_commit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Two Phase Commit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/alert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alert Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/assetServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/blockAssembly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Assembly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/blockValidation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/blockchain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blockchain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/propagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Propagation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/subtreeValidation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subtree Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/validator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Overlay Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overlay Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/blockPersister/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/p2p/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    P2P
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../P2P_NAT_TRAVERSAL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    P2P NAT Traversal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/legacy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Legacy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/rpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RPC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/utxoPersister/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Stores
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stores
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stores/blob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stores/utxo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_16" checked>
        
          
          <label class="md-nav__link" for="__nav_4_16" id="__nav_4_16_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Model
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_16_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Model
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../block_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Data Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../block_header_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Header Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subtree_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subtree Data Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transaction_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transaction Data Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    UTXO Data Model
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Data Model
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utxo-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO Data Model
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#individual-utxo-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Individual UTXO Encoding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Individual UTXO Encoding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unspent-utxo-format-32-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unspent UTXO Format (32 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spent-utxo-format-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spent UTXO Format (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frozen-utxo-encoding-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frozen UTXO Encoding (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Extraction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-to-live-ttl-fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time to Live (TTL) Fields
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aerospike-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aerospike Storage
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utxo-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO MetaData
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#txinpoints-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        TxInpoints Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TxInpoints Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Descriptions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utxo-state-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO State Lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UTXO State Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        State Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-transitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        State Transitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-state-descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed State Descriptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed State Descriptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#created-locked-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Created &amp; Locked State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unlocked-unmined-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unlocked &amp; Unmined State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mined-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mined State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unspent-state-32-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unspent State (32 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spent-state-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spent State (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frozen-state-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frozen State (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conflicting-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conflicting State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduled-for-deletion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scheduled for Deletion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storage-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record-pagination-20000-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Record Pagination (&gt;20,000 Outputs)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Record Pagination (&gt;20,000 Outputs)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagination-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pagination Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-record-index-0" class="md-nav__link">
    <span class="md-ellipsis">
      
        Master Record (Index 0)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#child-records-index-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Child Records (Index 1+)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagination-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pagination Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-blob-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Blob Storage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Blob Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger Conditions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        File Types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieval-from-external-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Retrieval from External Storage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-dah-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        External DAH Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-encoding-in-aerospike" class="md-nav__link">
    <span class="md-ellipsis">
      
        Binary Encoding in Aerospike
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Encoding in Aerospike">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-encoding-extended-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Encoding (Extended Format)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Encoding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utxo-array-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO Array Encoding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-source-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Source Calculation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Source Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master-record-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Master Record Key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#child-record-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Child Record Keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spend-lookup-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spend Lookup Keys
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-size-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Size Limits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_17" >
        
          
          <label class="md-nav__link" for="__nav_4_17" id="__nav_4_17_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Kafka
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kafka
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kafka/kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kafka Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_18" >
        
          
          <label class="md-nav__link" for="__nav_4_18" id="__nav_4_18_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_18">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/seeder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seeder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/projectStructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Project Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API & Protobuf
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API & Protobuf
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/errorHandling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/codingConventions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coding Conventions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/kafkaMessageFormat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kafka Message Format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/networkConsensusRules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Consensus Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2_6" >
        
          
          <label class="md-nav__link" for="__nav_5_2_6" id="__nav_5_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Protobuf API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Protobuf API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/alertProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alert Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockassemblyProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Assembly Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockchainProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blockchain Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockvalidationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Validation Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/propagationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Propagation Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/subtreevalidationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subtree Validation Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/validatorProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validator Proto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/alert_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alert Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/asset_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockassembly_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Assembly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockvalidation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockchain_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blockchain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/propagation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Propagation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/subtreevalidation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subtree Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/validator_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overlay Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overlay Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockpersister_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/p2p_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    P2P
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/legacy_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    P2P Legacy Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/rpc_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RPC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/utxopersister_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stores
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stores
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/stores/blob_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/stores/utxo_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Settings Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Settings Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/global_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Global Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/policy_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/kafka_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kafka Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6_6" id="__nav_5_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Service Settings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Service Settings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/alert_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alert
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/asset_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asset Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockassembly_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Assembly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockchain_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blockchain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockpersister_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockvalidation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Block Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/legacy_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Legacy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/p2p_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    P2P
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/propagation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Propagation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/rpc_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RPC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/subtreevalidation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subtree Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/utxopersister_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Persister
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/validator_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6_7" >
        
          
          <label class="md-nav__link" for="__nav_5_6_7" id="__nav_5_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Store Settings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Store Settings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/stores/aerospike_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aerospike Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/stores/blob_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/stores/utxo_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UTXO Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Miscellaneous
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Miscellaneous
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/BIP-239/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIP-239 (Transaction Extended Format)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/gitCommitSigningSetupGuide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Git Commit Signing Setup Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/licenseInformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Licensing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/prometheusMetrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prometheus Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/teranodeDaemonReference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Teranode Daemon Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/testingTechnicalReference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Technical Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/thirdPartySoftwareRequirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Third-Party Software Requirements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utxo-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO Data Model
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#individual-utxo-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Individual UTXO Encoding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Individual UTXO Encoding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unspent-utxo-format-32-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unspent UTXO Format (32 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spent-utxo-format-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spent UTXO Format (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frozen-utxo-encoding-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frozen UTXO Encoding (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Extraction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-to-live-ttl-fields" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time to Live (TTL) Fields
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aerospike-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aerospike Storage
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utxo-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO MetaData
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#txinpoints-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        TxInpoints Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TxInpoints Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure Definition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Field Descriptions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utxo-state-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO State Lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UTXO State Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#state-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        State Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-transitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        State Transitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-state-descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed State Descriptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed State Descriptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#created-locked-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Created &amp; Locked State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unlocked-unmined-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unlocked &amp; Unmined State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mined-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mined State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unspent-state-32-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unspent State (32 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spent-state-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spent State (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frozen-state-68-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Frozen State (68 bytes)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conflicting-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conflicting State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduled-for-deletion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scheduled for Deletion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storage-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Architecture Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record-pagination-20000-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Record Pagination (&gt;20,000 Outputs)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Record Pagination (&gt;20,000 Outputs)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pagination-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pagination Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-record-index-0" class="md-nav__link">
    <span class="md-ellipsis">
      
        Master Record (Index 0)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#child-records-index-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Child Records (Index 1+)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagination-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pagination Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-blob-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Blob Storage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Blob Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger Conditions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        File Types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieval-from-external-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Retrieval from External Storage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-dah-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        External DAH Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-encoding-in-aerospike" class="md-nav__link">
    <span class="md-ellipsis">
      
        Binary Encoding in Aerospike
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Encoding in Aerospike">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-encoding-extended-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Encoding (Extended Format)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Encoding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utxo-array-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        UTXO Array Encoding
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-source-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Source Calculation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Source Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master-record-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Master Record Key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#child-record-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Child Record Keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spend-lookup-keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spend Lookup Keys
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-size-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Storage Size Limits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="teranode-data-model-utxo">Teranode Data Model - UTXO</h1>
<h2 id="utxo-data-model">UTXO Data Model</h2>
<p>For every transaction, a UTXO record is stored in the database. The record contains the following fields:</p>
<table>
<thead>
<tr>
<th><strong>Field Name</strong></th>
<th><strong>Data Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>utxos</strong></td>
<td><code>Array of Byte[32] or Byte[68]</code></td>
<td>A list of UTXOs stored as variable-length byte arrays. Each unspent UTXO is 32 bytes (UTXO hash only). Each spent UTXO is 68 bytes: 32-byte UTXO hash + 36-byte spending data (32-byte spending transaction ID + 4-byte little-endian input index).</td>
</tr>
<tr>
<td><strong>utxoSpendableIn</strong></td>
<td><code>Map&lt;Integer, Integer&gt;</code></td>
<td>A map where the key is the UTXO offset and the value is the block height after which the UTXO is spendable.</td>
</tr>
<tr>
<td><strong>recordUtxos</strong></td>
<td><code>Integer</code></td>
<td>Total number of UTXOs in this record.</td>
</tr>
<tr>
<td><strong>spentUtxos</strong></td>
<td><code>Integer</code></td>
<td>Number of UTXOs that have been spent in this record.</td>
</tr>
<tr>
<td><strong>frozen</strong></td>
<td><code>Boolean</code></td>
<td>Indicates whether the UTXO or transaction is frozen.</td>
</tr>
<tr>
<td><strong>locked</strong></td>
<td><code>Boolean</code></td>
<td>Indicates whether the transaction outputs can be spent. Part of the two-phase commit protocol. Set to true during initial creation when the transaction is validated. Set to false in two scenarios: (1) after successful addition to block assembly, or (2) when mined via <code>SetMinedMulti</code>. See <a href="../../features/two_phase_commit/">Two-Phase Commit Process</a> for complete workflow.</td>
</tr>
<tr>
<td><strong>spendingDatas</strong></td>
<td><code>[]*spendpkg.SpendingData</code></td>
<td>Array tracking which transactions spent which outputs. Each element corresponds to an output index and contains the spending transaction ID and input index. Nil for unspent outputs. Critical for validation and reorganization handling.</td>
</tr>
<tr>
<td><strong>conflicting</strong></td>
<td><code>Boolean</code></td>
<td>Indicates whether this transaction is a double spend.</td>
</tr>
<tr>
<td><strong>conflictingChildren</strong></td>
<td><code>Array&lt;chainhash.Hash&gt;</code></td>
<td>List of transaction hashes that spend from this transaction and are also marked as conflicting.</td>
</tr>
<tr>
<td><strong>unminedSince</strong></td>
<td><code>uint32</code></td>
<td>When set to a non-zero block height, indicates the transaction is unmined on the longest chain and tracks when it was first stored. When 0 (zero), indicates the transaction has been mined on the longest chain. Enables transaction recovery after service restarts.</td>
</tr>
<tr>
<td><strong>createdAt</strong></td>
<td><code>Integer (Timestamp)</code></td>
<td>The timestamp when the unmined transaction was first added to the store. Used for ordering transactions during recovery.</td>
</tr>
<tr>
<td><strong>preserveUntil</strong></td>
<td><code>Integer (Block Height)</code></td>
<td>Specifies a block height until which a transaction should be preserved from deletion. Used to protect parent transactions of unmined transactions from being deleted during cleanup operations.</td>
</tr>
<tr>
<td><strong>spendingHeight</strong></td>
<td><code>uint32</code></td>
<td>For coinbase transactions, stores the block height after which outputs become spendable. BSV enforces a 100-block maturity period, so this is set to <code>coinbase_block_height + 100</code>. Zero for non-coinbase transactions.</td>
</tr>
<tr>
<td><strong>blockIDs</strong></td>
<td><code>Array&lt;Integer&gt;</code></td>
<td>List of block IDs that reference this UTXO.</td>
</tr>
<tr>
<td><strong>blockHeights</strong></td>
<td><code>Array&lt;uint32&gt;</code></td>
<td>List of block heights where this transaction appears. Used by the validator to identify the height at which a UTXO was mined.</td>
</tr>
<tr>
<td><strong>subtreeIdxs</strong></td>
<td><code>Array&lt;int&gt;</code></td>
<td>List of subtree indexes where this transaction appears within blocks.</td>
</tr>
<tr>
<td><strong>external</strong></td>
<td><code>Boolean</code></td>
<td>Flag indicating whether the transaction is stored externally (used for fetching external raw transaction data).</td>
</tr>
<tr>
<td><strong>totalExtraRecs</strong></td>
<td><code>Integer (Optional)</code></td>
<td>The number of UTXO records associated with the transaction, used for pagination.</td>
</tr>
<tr>
<td><strong>reassignments</strong></td>
<td><code>Array&lt;Map&gt;</code></td>
<td>Tracks UTXO reassignments. Contains maps with keys such as <code>offset</code>, <code>utxoHash</code>, <code>newUtxoHash</code>, and <code>blockHeight</code>.</td>
</tr>
<tr>
<td><strong>tx</strong></td>
<td><code>bt.Tx Object</code></td>
<td>Raw transaction data containing inputs, outputs, version, and locktime.</td>
</tr>
<tr>
<td><strong>fee</strong></td>
<td><code>Integer</code></td>
<td>Transaction fee associated with this UTXO.</td>
</tr>
<tr>
<td><strong>sizeInBytes</strong></td>
<td><code>Integer</code></td>
<td>The size of the transaction in bytes.</td>
</tr>
<tr>
<td><strong>txInpoints</strong></td>
<td><code>TxInpoints</code></td>
<td>Transaction input outpoints containing parent transaction hashes and their corresponding output indices.</td>
</tr>
<tr>
<td><strong>isCoinbase</strong></td>
<td><code>Boolean</code></td>
<td>Indicates whether this UTXO is from a coinbase transaction.</td>
</tr>
</tbody>
</table>
<h2 id="individual-utxo-encoding">Individual UTXO Encoding</h2>
<p>Each UTXO in the <code>utxos</code> array uses a variable-length binary encoding that indicates whether the output has been spent.</p>
<h3 id="unspent-utxo-format-32-bytes">Unspent UTXO Format (32 bytes)</h3>
<p>An unspent UTXO contains only the UTXO hash:</p>
<table>
<thead>
<tr>
<th>Byte Range</th>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[0:32]</td>
<td>32 bytes</td>
<td>UTXO Hash</td>
<td>Little-endian hash uniquely identifying this output</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: A transaction with 5 outputs creates 5 unspent UTXOs, each 32 bytes.</p>
<h3 id="spent-utxo-format-68-bytes">Spent UTXO Format (68 bytes)</h3>
<p>When a UTXO is spent, spending data is appended:</p>
<table>
<thead>
<tr>
<th>Byte Range</th>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[0:32]</td>
<td>32 bytes</td>
<td>UTXO Hash</td>
<td>Little-endian hash of the original UTXO</td>
</tr>
<tr>
<td>[32:64]</td>
<td>32 bytes</td>
<td>Spending TX ID</td>
<td>Little-endian hash of the transaction that spent this UTXO</td>
</tr>
<tr>
<td>[64:68]</td>
<td>4 bytes</td>
<td>Input Index</td>
<td>Little-endian uint32 indicating which input in the spending transaction consumed this UTXO</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong>: When output 0 of transaction A is spent by input 2 of transaction B, the UTXO grows from 32 to 68 bytes, with bytes [32:64] containing transaction B's ID and bytes [64:68] containing <code>0x02000000</code> (little-endian 2).</p>
<h3 id="frozen-utxo-encoding-68-bytes">Frozen UTXO Encoding (68 bytes)</h3>
<p>Frozen UTXOs (managed by the alert system) use a special spending data pattern:</p>
<table>
<thead>
<tr>
<th>Byte Range</th>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[0:32]</td>
<td>32 bytes</td>
<td>UTXO Hash</td>
<td>Original UTXO hash</td>
</tr>
<tr>
<td>[32:68]</td>
<td>36 bytes</td>
<td>Frozen Marker</td>
<td>All 36 bytes set to <code>0xFF</code> (255)</td>
</tr>
</tbody>
</table>
<p><strong>Detection</strong> (from <code>stores/utxo/aerospike/teranode.lua</code>):</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">FROZEN_BYTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">255</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">SPENDING_DATA_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span>

<span class="kr">function</span><span class="w"> </span><span class="nf">isFrozen</span><span class="p">(</span><span class="nv">spendingData</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">spendingData</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">SPENDING_DATA_SIZE</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">spendingData</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="nv">FROZEN_BYTE</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="kc">true</span>
<span class="kr">end</span>
</code></pre></div>
<h3 id="field-extraction">Field Extraction</h3>
<p>The Lua implementation in <code>stores/utxo/aerospike/teranode.lua</code> extracts fields as follows:</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Get UTXO from array (Lua arrays are 1-based)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">utxo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">utxos</span><span class="p">[</span><span class="nv">offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>

<span class="c1">-- Extract UTXO hash (always present)</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">utxoHash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">bytes</span><span class="p">.</span><span class="nf">get_bytes</span><span class="p">(</span><span class="nv">utxo</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>

<span class="c1">-- Check if spent</span>
<span class="kr">if</span><span class="w"> </span><span class="nv">bytes</span><span class="p">.</span><span class="nf">size</span><span class="p">(</span><span class="nv">utxo</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">68</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="c1">-- Extract spending transaction ID</span>
<span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">spendingTxID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">bytes</span><span class="p">.</span><span class="nf">get_bytes</span><span class="p">(</span><span class="nv">utxo</span><span class="p">,</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>

<span class="w">    </span><span class="c1">-- Extract input index</span>
<span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">inputIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">bytes</span><span class="p">.</span><span class="nf">get_bytes</span><span class="p">(</span><span class="nv">utxo</span><span class="p">,</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">    </span><span class="c1">-- Check if frozen</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nf">isFrozen</span><span class="p">(</span><span class="nv">spendingData</span><span class="p">)</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="c1">-- UTXO is frozen by alert system</span>
<span class="w">    </span><span class="kr">end</span>
<span class="kr">end</span>
</code></pre></div>
<p><strong>Size-Based State Detection</strong>:</p>
<ul>
<li><code>size == 32</code>  Unspent</li>
<li><code>size == 68 &amp;&amp; !frozen</code>  Spent normally</li>
<li><code>size == 68 &amp;&amp; frozen</code>  Frozen by alert system</li>
</ul>
<p>Additionally, note how the raw transaction data (<strong>tx (bt.Tx Object)</strong>) is stored in the record. This includes:</p>
<ul>
<li><strong>Version</strong>: The transaction version.</li>
<li><strong>LockTime</strong>: The transaction lock time.</li>
<li><strong>Inputs</strong>: Array of inputs used in the transaction.</li>
<li><strong>Outputs</strong>: Array of outputs (UTXOs) created by the transaction.</li>
</ul>
<h2 id="time-to-live-ttl-fields">Time to Live (TTL) Fields</h2>
<p>Typically, UTXO records are kept with a time-to-live value that is set when all UTXOs in a record are spent or reassigned.</p>
<table>
<thead>
<tr>
<th><strong>Field Name</strong></th>
<th><strong>Data Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TTL</strong></td>
<td><code>Integer</code></td>
<td>Time-to-live value for the record. Set when:<br/>- All UTXOs in a record are spent or reassigned<br/>- Transaction is marked as conflicting</td>
</tr>
</tbody>
</table>
<h2 id="aerospike-storage">Aerospike Storage</h2>
<p>If storing in Aerospike, the UTXO record is stored as a bin in the Aerospike database. The bin contains the UTXO data in a serialized format, containing up to 1024 bytes.</p>
<p><img alt="AerospikeRecord.png" src="../../services/img/AerospikeRecord.png" /></p>
<p>For more information, please refer to the official Aerospike documentation: <a href="https://aerospike.com">https://aerospike.com</a>.</p>
<h2 id="utxo-metadata">UTXO MetaData</h2>
<p>For convenience, the UTXO can be decorated using the <code>UTXO MetaData</code> format, widely used in Teranode:</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tx</td>
<td>The raw transaction data.</td>
<td>*bt.Tx Object</td>
</tr>
<tr>
<td>Hash</td>
<td>Unique identifier for the transaction.</td>
<td>String/Hexadecimal</td>
</tr>
<tr>
<td>Fee</td>
<td>The fee associated with the transaction.</td>
<td>Decimal</td>
</tr>
<tr>
<td>Size in Bytes</td>
<td>The size of the transaction in bytes.</td>
<td>Integer</td>
</tr>
<tr>
<td>TxInpoints</td>
<td>Transaction input outpoints containing parent transaction hashes and their corresponding output indices.</td>
<td>TxInpoints Object</td>
</tr>
<tr>
<td>BlockIDs</td>
<td>List of IDs of the blocks that include this transaction.</td>
<td>Array of Integers</td>
</tr>
<tr>
<td>BlockHeights</td>
<td>List of block heights where this transaction appears.</td>
<td>Array of Integers</td>
</tr>
<tr>
<td>SubtreeIdxs</td>
<td>List of subtree indexes where this transaction appears within blocks.</td>
<td>Array of Integers</td>
</tr>
<tr>
<td>LockTime</td>
<td>The earliest time or block number that this transaction can be included in the blockchain.</td>
<td>Integer/Timestamp or Block Number</td>
</tr>
<tr>
<td>IsCoinbase</td>
<td>Indicates whether the transaction is a coinbase transaction.</td>
<td>Boolean</td>
</tr>
<tr>
<td>Locked</td>
<td>Flag indicating whether the transaction outputs can be spent. Part of the two-phase commit process for block assembly.</td>
<td>Boolean</td>
</tr>
<tr>
<td>Conflicting</td>
<td>Indicates whether this transaction is a double spend.</td>
<td>Boolean</td>
</tr>
<tr>
<td>ConflictingChildren</td>
<td>List of transaction hashes that spend from this transaction and are also marked as conflicting.</td>
<td>Array of Strings/Hexadecimals</td>
</tr>
</tbody>
</table>
<h2 id="txinpoints-structure">TxInpoints Structure</h2>
<blockquote>
<p><strong>External Package</strong>: The <code>TxInpoints</code> structure is defined in the external <code>github.com/bsv-blockchain/go-subtree</code> package. The implementation details below are provided for reference and developer convenience.</p>
</blockquote>
<p>The <code>TxInpoints</code> field contains complete outpoint information for all transaction inputs, providing precise identification of which UTXOs are being consumed by a transaction.</p>
<h3 id="structure-definition">Structure Definition</h3>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">TxInpoints</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ParentTxHashes</span><span class="w"> </span><span class="p">[]</span><span class="nx">chainhash</span><span class="p">.</span><span class="nx">Hash</span><span class="w">  </span><span class="c1">// Array of parent transaction hashes</span>
<span class="w">    </span><span class="nx">Idxs</span><span class="w">           </span><span class="p">[][]</span><span class="kt">uint32</span><span class="w">        </span><span class="c1">// Array of arrays containing output indices for each parent transaction</span>
<span class="w">    </span><span class="nx">nrInpoints</span><span class="w">     </span><span class="kt">int</span><span class="w">               </span><span class="c1">// Internal variable tracking total number of inpoints</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="field-descriptions">Field Descriptions</h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ParentTxHashes</code></td>
<td><code>[]chainhash.Hash</code></td>
<td>Array of unique parent transaction hashes from which this transaction consumes UTXOs</td>
</tr>
<tr>
<td><code>Idxs</code></td>
<td><code>[][]uint32</code></td>
<td>Parallel array to <code>ParentTxHashes</code>. Each element contains the output indices being consumed from the corresponding parent transaction</td>
</tr>
<tr>
<td><code>nrInpoints</code></td>
<td><code>int</code></td>
<td>Internal counter tracking the total number of individual outpoints across all parent transactions</td>
</tr>
</tbody>
</table>
<h3 id="key-features">Key Features</h3>
<ol>
<li>
<p><strong>Complete Outpoint Information</strong>: Each input is precisely identified by both the parent transaction hash and the specific output index being consumed.</p>
</li>
<li>
<p><strong>Efficient Storage</strong>: Uses parallel arrays to avoid duplicating parent transaction hashes when multiple outputs from the same transaction are consumed.</p>
</li>
<li>
<p><strong>Validation Support</strong>: Enables validators to quickly determine exactly which UTXOs are being spent without additional lookups.</p>
</li>
<li>
<p><strong>Chained Transaction Support</strong>: Facilitates handling of complex transaction chains where multiple outputs from the same parent transaction are consumed.</p>
</li>
</ol>
<h3 id="example">Example</h3>
<p>For a transaction consuming:</p>
<ul>
<li>Output 0 of transaction A</li>
<li>Output 2 of transaction A</li>
<li>Output 1 of transaction B</li>
</ul>
<p>The TxInpoints structure would contain:</p>
<div class="highlight"><pre><span></span><code>ParentTxHashes: [hashA, hashB]
Idxs: [[0, 2], [1]]
</code></pre></div>
<p>This structure efficiently represents that the transaction consumes three UTXOs total: two from transaction A (outputs 0 and 2) and one from transaction B (output 1).</p>
<p>Note:</p>
<ul>
<li>
<p><strong>Blocks</strong>: 1 or more block hashes. Each block represents a block that mined the transaction.</p>
</li>
<li>
<p>Typically, a tx should only belong to one block. i.e. a) a tx is created (and its meta is stored in the UTXO store) and b) the tx is mined, and the mined block hash is tracked in the UTXO store for the given transaction.</p>
</li>
<li>
<p>However, in the case of a fork, a tx can be mined in multiple blocks by different nodes. In this case, the UTXO store will track multiple block hashes for the given transaction, until such time that the fork is resolved and only one block is considered valid.</p>
</li>
<li>
<p><strong>Block Heights and Subtree Indexes</strong>: These fields track the exact location of transactions within the blockchain.</p>
<ul>
<li>The block heights array is particularly important for validation, as it gives visibility on what height a UTXO was mined. While most UTXOs are mined at the same height across parallel chains or forks, this is not always the case. Storing this information enables the validator to efficiently determine the height of UTXOs being spent without performing expensive lookups. Block heights indicate how deep in the chain a transaction is, which is important for maturity checks.</li>
<li>The subtree indexes are primarily informational, allowing for future features that might need to locate exactly where a transaction was placed within a block's structure, enabling potential parallel processing and efficient lookups.</li>
</ul>
</li>
</ul>
<h2 id="utxo-state-lifecycle">UTXO State Lifecycle</h2>
<p>A UTXO progresses through multiple states during its lifecycle, from creation through spending to eventual cleanup. Understanding these states is critical for implementing consensus rules, validation logic, and cleanup operations.</p>
<h3 id="state-overview">State Overview</h3>
<table>
<thead>
<tr>
<th>State</th>
<th>Key Indicators</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Created &amp; Locked</strong></td>
<td><code>locked=true</code>, <code>unminedSince&gt;0</code>, <code>blockIDs=[]</code></td>
<td>Transaction validated and stored, outputs not yet spendable. Part of two-phase commit protocol.</td>
</tr>
<tr>
<td><strong>Unlocked &amp; Unmined</strong></td>
<td><code>locked=false</code>, <code>unminedSince&gt;0</code>, <code>blockIDs=[]</code></td>
<td>Transaction outputs spendable but not yet mined in a block.</td>
</tr>
<tr>
<td><strong>Mined</strong></td>
<td><code>unminedSince=0</code>, <code>blockIDs</code> populated</td>
<td>Transaction included in a block on the longest chain. UTXOs become permanently spendable (subject to maturity rules).</td>
</tr>
<tr>
<td><strong>Unspent</strong></td>
<td>UTXO size = 32 bytes</td>
<td>Output has not been consumed by any transaction.</td>
</tr>
<tr>
<td><strong>Spent</strong></td>
<td>UTXO size = 68 bytes, not frozen</td>
<td>Output consumed by another transaction. Contains spending transaction ID and input index.</td>
</tr>
<tr>
<td><strong>Frozen</strong></td>
<td>UTXO size = 68 bytes, frozen pattern (0xFF)</td>
<td>Output frozen by alert system. Cannot be spent until unfrozen.</td>
</tr>
<tr>
<td><strong>Conflicting</strong></td>
<td><code>conflicting=true</code></td>
<td>Transaction is a double-spend attempt. All outputs marked as invalid.</td>
</tr>
<tr>
<td><strong>Scheduled for Deletion</strong></td>
<td><code>deleteAtHeight</code> set</td>
<td>All outputs spent or transaction conflicting. Will be deleted at specified block height.</td>
</tr>
</tbody>
</table>
<h3 id="state-transitions">State Transitions</h3>
<p>The following table shows valid state transitions and their triggers:</p>
<table>
<thead>
<tr>
<th>From State</th>
<th>To State</th>
<th>Trigger</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Created &amp; Locked</td>
<td>Unlocked &amp; Unmined</td>
<td>Block assembly completion or explicit unlock</td>
<td><code>SetLocked(false)</code> in <code>stores/utxo/aerospike/locked.go</code></td>
</tr>
<tr>
<td>Unlocked &amp; Unmined</td>
<td>Mined</td>
<td>Transaction included in block on longest chain</td>
<td><code>SetMinedMulti()</code> in <code>stores/utxo/aerospike/set_mined.go</code></td>
</tr>
<tr>
<td>Mined</td>
<td>Unlocked &amp; Unmined</td>
<td>Block reorganization removes tx from longest chain</td>
<td><code>SetMinedMulti()</code> with <code>UnsetMined=true</code></td>
</tr>
<tr>
<td>Unspent (32B)</td>
<td>Spent (68B)</td>
<td>UTXO consumed by validated transaction</td>
<td><code>Spend()</code> in <code>stores/utxo/aerospike/spend.go</code></td>
</tr>
<tr>
<td>Spent (68B)</td>
<td>Unspent (32B)</td>
<td>Block reorganization or validation rollback</td>
<td><code>Unspend()</code> in <code>stores/utxo/aerospike/un_spend.go</code></td>
</tr>
<tr>
<td>Any</td>
<td>Frozen</td>
<td>Alert system freeze command</td>
<td><code>FreezeUTXO()</code> in <code>stores/utxo/aerospike/alert_system.go</code></td>
</tr>
<tr>
<td>Frozen</td>
<td>Unspent or Spent</td>
<td>Alert system unfreeze command</td>
<td><code>UnfreezeUTXO()</code> in <code>stores/utxo/aerospike/alert_system.go</code></td>
</tr>
<tr>
<td>Any</td>
<td>Conflicting</td>
<td>Double-spend detected</td>
<td><code>ProcessConflicting()</code> in <code>stores/utxo/process_conflicting.go</code></td>
</tr>
<tr>
<td>Any</td>
<td>Scheduled for Deletion</td>
<td>All UTXOs spent or tx conflicting</td>
<td>Lua script signals in <code>stores/utxo/aerospike/teranode.lua</code></td>
</tr>
</tbody>
</table>
<h3 id="detailed-state-descriptions">Detailed State Descriptions</h3>
<h4 id="created-locked-state">Created &amp; Locked State</h4>
<p>When a transaction is first validated and stored:</p>
<ul>
<li><code>locked</code> field is set to <code>true</code> during <code>Create()</code> operation</li>
<li><code>unminedSince</code> field is set to current block height</li>
<li><code>blockIDs</code>, <code>blockHeights</code>, <code>subtreeIdxs</code> arrays are empty</li>
<li>Outputs <strong>cannot be spent</strong> while in this state</li>
<li>Part of the two-phase commit protocol for block assembly</li>
<li>Prevents race conditions where transactions are spent before block assembly completes</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li>Successful block assembly  <code>SetLocked(false)</code>  transitions to Unlocked &amp; Unmined</li>
<li>Transaction mined via <code>SetMinedMulti()</code>  automatically unlocks and transitions to Mined</li>
</ul>
<h4 id="unlocked-unmined-state">Unlocked &amp; Unmined State</h4>
<p>After unlock but before mining:</p>
<ul>
<li><code>locked=false</code>, allowing outputs to be spent</li>
<li><code>unminedSince</code> still set to block height when first stored</li>
<li><code>blockIDs</code> array still empty</li>
<li>Outputs <strong>can be spent</strong> by other transactions</li>
<li>Enables transaction chains where child transactions spend parent outputs before mining</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li>Transaction mined  <code>SetMinedMulti()</code> sets <code>unminedSince=0</code>, populates <code>blockIDs</code></li>
<li>Transaction becomes conflicting  marked as double-spend</li>
</ul>
<h4 id="mined-state">Mined State</h4>
<p>Transaction permanently recorded in blockchain:</p>
<ul>
<li><code>unminedSince=0</code> (zero indicates mined)</li>
<li><code>blockIDs</code> array contains at least one block ID</li>
<li><code>blockHeights</code> array contains corresponding block heights</li>
<li><code>subtreeIdxs</code> array contains subtree positions within blocks</li>
<li>During forks, arrays may contain multiple entries (one per fork branch)</li>
<li>After fork resolution, only longest chain block remains</li>
</ul>
<p><strong>Special case - Coinbase maturity:</strong></p>
<ul>
<li>Coinbase transactions set <code>spendingHeight = coinbase_block_height + 100</code></li>
<li>Outputs cannot be spent until chain reaches <code>spendingHeight</code></li>
<li>Enforces BSV's 100-block maturity rule for coinbase rewards</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li>Block reorganization removes block from longest chain  <code>SetMinedMulti()</code> with <code>UnsetMined=true</code></li>
<li>Sets <code>unminedSince</code> back to block height, clears block references</li>
</ul>
<h4 id="unspent-state-32-bytes">Unspent State (32 bytes)</h4>
<p>UTXO has not been consumed:</p>
<ul>
<li>UTXO entry in <code>utxos</code> array is exactly 32 bytes</li>
<li>Contains only the UTXO hash (little-endian)</li>
<li>Can be spent by any valid transaction (subject to maturity rules)</li>
<li>Detection: <code>bytes.size(utxo) == 32</code> in Lua scripts</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li><code>Spend()</code> operation adds 36-byte spending data  transitions to Spent</li>
<li>Alert system freeze  spending data set to 0xFF pattern  transitions to Frozen</li>
</ul>
<h4 id="spent-state-68-bytes">Spent State (68 bytes)</h4>
<p>UTXO consumed by another transaction:</p>
<ul>
<li>UTXO entry grows to 68 bytes total</li>
<li>Bytes [0:32]: Original UTXO hash</li>
<li>Bytes [32:64]: Spending transaction ID (32 bytes, little-endian)</li>
<li>Bytes [64:68]: Input index in spending transaction (4 bytes, little-endian uint32)</li>
<li>Detection: <code>bytes.size(utxo) == 68 &amp;&amp; !isFrozen()</code> in Lua scripts</li>
</ul>
<p><strong>Tracking:</strong></p>
<ul>
<li><code>spentUtxos</code> counter incremented</li>
<li>When <code>spentUtxos == recordUtxos</code>, signals <code>LuaSignalAllSpent</code></li>
<li>Triggers DAH (Delete At Height) setting for cleanup</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li>Block reorganization or validation rollback  <code>Unspend()</code> removes 36-byte spending data</li>
<li>Alert system freeze  spending data changed to 0xFF pattern  transitions to Frozen</li>
</ul>
<h4 id="frozen-state-68-bytes">Frozen State (68 bytes)</h4>
<p>UTXO frozen by alert system:</p>
<ul>
<li>UTXO entry is 68 bytes with special pattern</li>
<li>Bytes [0:32]: Original UTXO hash</li>
<li>Bytes [32:68]: All 36 bytes set to <code>0xFF</code> (255)</li>
<li>Cannot be spent until explicitly unfrozen</li>
<li>Spending attempts return <code>LuaErrorCodeFrozen</code> error</li>
<li>
<p>Detection logic from <code>stores/utxo/aerospike/teranode.lua</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">FROZEN_BYTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">255</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">SPENDING_DATA_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span>

<span class="kr">function</span><span class="w"> </span><span class="nf">isFrozen</span><span class="p">(</span><span class="nv">spendingData</span><span class="p">)</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">spendingData</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">SPENDING_DATA_SIZE</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="kr">if</span><span class="w"> </span><span class="nv">spendingData</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="nv">FROZEN_BYTE</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">end</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="kc">true</span>
<span class="kr">end</span>
</code></pre></div>
</li>
</ul>
<p><strong>Conditional freeze:</strong></p>
<ul>
<li>UTXOs can also be frozen until a specific block height using <code>utxoSpendableIn</code> map</li>
<li>Spending attempts before the height return <code>LuaErrorCodeFrozenUntil</code> error</li>
<li>Automatically unfreezes when blockchain reaches the specified height</li>
</ul>
<p><strong>Exit conditions:</strong></p>
<ul>
<li>Alert system unfreeze  removes 0xFF pattern, restores previous state</li>
</ul>
<h4 id="conflicting-state">Conflicting State</h4>
<p>Transaction marked as double-spend:</p>
<ul>
<li><code>conflicting=true</code> flag set</li>
<li>All outputs become invalid and unspendable</li>
<li><code>conflictingChildren</code> array tracks any transactions that attempted to spend from this conflicting transaction</li>
<li>TTL (Time-To-Live) set immediately for cleanup</li>
<li>Processed by <code>ProcessConflicting()</code> in <code>stores/utxo/process_conflicting.go</code></li>
</ul>
<p><strong>Implications:</strong></p>
<ul>
<li>Cannot transition out of conflicting state (terminal state)</li>
<li>Entire transaction tree marked as conflicting</li>
<li>Cleanup occurs after TTL expiration</li>
</ul>
<h4 id="scheduled-for-deletion">Scheduled for Deletion</h4>
<p>Record marked for automatic cleanup:</p>
<ul>
<li><code>deleteAtHeight</code> field set to specific block height</li>
<li>Occurs when all UTXOs in record are spent or reassigned</li>
<li>Occurs when transaction marked as conflicting</li>
<li>Also set via <code>preserveUntil</code> field to protect parent transactions</li>
<li>Aerospike TTL automatically deletes record when blockchain reaches specified height</li>
<li>Child pagination records also have DAH set via <code>SetDAHForChildRecords()</code></li>
<li>External blob storage has DAH set via <code>setDAHExternalTransaction()</code></li>
</ul>
<p><strong>Triggers:</strong></p>
<ul>
<li><code>LuaSignalDAHSet</code> signal from Lua scripts when last UTXO spent</li>
<li><code>LuaSignalDAHUnset</code> signal when previously spent UTXO is unspent (reorganization)</li>
<li>Formula: <code>deleteAtHeight = currentBlockHeight + blockHeightRetention</code></li>
</ul>
<p><strong>Implementation:</strong></p>
<ul>
<li>Main record: DAH set via Lua script during <code>Spend()</code> or <code>SetMined()</code></li>
<li>Pagination records: <code>SetDAHForChildRecords()</code> updates all child records</li>
<li>External transactions: <code>setDAHExternalTransaction()</code> updates blob storage metadata</li>
</ul>
<h2 id="storage-implementation">Storage Implementation</h2>
<p>UTXO records are stored using different strategies based on transaction size and output count. Teranode uses a hybrid storage approach combining Aerospike key-value store with external blob storage to handle transactions of any size efficiently.</p>
<h3 id="storage-architecture-overview">Storage Architecture Overview</h3>
<div class="highlight"><pre><span></span><code>Transaction Size Check
         
         &gt; Small (&lt;1MB, 20K outputs)
             &gt; Single Aerospike Record
                   Transaction data (inputs/outputs)
                   UTXO array (32 or 68 bytes each)
                   Metadata (fee, blockIDs, etc.)
         
         &gt; Medium (1MB, &gt;20K outputs)
             &gt; Multiple Aerospike Records (Pagination)
                   Master Record (index 0)
                     Full transaction data
                     First 20K UTXOs
                     Metadata + totalExtraRecs
                   Child Records (index 1, 2, 3...)
                      Next 20K UTXOs per record
                      Subset of metadata
         
         &gt; Large (&gt;1MB or force external)
              &gt; External Blob Storage + Aerospike
                    Blob Storage
                      FileTypeTx (.tx) - Full transaction
                      FileTypeOutputs (.outputs) - Outputs only
                    Aerospike Records
                       external=true flag
                       UTXO arrays (paginated if &gt;20K)
                       Metadata only (no tx data)
</code></pre></div>
<h3 id="record-pagination-20000-outputs">Record Pagination (&gt;20,000 Outputs)</h3>
<p>Transactions with more than 20,000 outputs are automatically split across multiple Aerospike records to stay within database size constraints.</p>
<h4 id="pagination-strategy">Pagination Strategy</h4>
<ul>
<li><strong>Batch Size</strong>: 20,000 UTXOs per record (configurable via <code>utxoBatchSize</code> setting)</li>
<li><strong>Master Record</strong> (index 0): Contains first batch of UTXOs plus complete metadata</li>
<li><strong>Child Records</strong> (index 1+): Contain subsequent UTXO batches with limited metadata</li>
</ul>
<p><strong>Key Calculation</strong> (from <code>stores/utxo/aerospike/create.go</code>):</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Master record key</span>
<span class="nx">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">hash</span><span class="p">(</span><span class="nx">txID</span><span class="p">)</span>

<span class="c1">// Child record keys</span>
<span class="nx">keySource</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">hash</span><span class="p">(</span><span class="nx">txID</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">childIndex</span><span class="p">)</span><span class="w">  </span><span class="c1">// childIndex = 1, 2, 3...</span>
</code></pre></div>
<h4 id="master-record-index-0">Master Record (Index 0)</h4>
<p>Contains complete transaction metadata and first UTXO batch:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tx</code> or <code>external</code></td>
<td>Full transaction data OR external=true flag</td>
<td>Always</td>
</tr>
<tr>
<td><code>utxos</code></td>
<td>First 20,000 UTXO entries</td>
<td>Always</td>
</tr>
<tr>
<td><code>totalUtxos</code></td>
<td>Total count of ALL UTXOs across all records</td>
<td>Always</td>
</tr>
<tr>
<td><code>totalExtraRecs</code></td>
<td>Number of child records (pagination records)</td>
<td>If &gt;20K outputs</td>
</tr>
<tr>
<td><code>recordUtxos</code></td>
<td>Number of non-nil UTXOs in THIS record</td>
<td>Always</td>
</tr>
<tr>
<td><code>spentUtxos</code></td>
<td>Number of spent UTXOs in THIS record</td>
<td>Always</td>
</tr>
<tr>
<td><code>spentExtraRecs</code></td>
<td>Number of child records fully spent</td>
<td>If &gt;20K outputs</td>
</tr>
<tr>
<td><code>blockIDs</code>, <code>blockHeights</code>, <code>subtreeIdxs</code></td>
<td>Block references</td>
<td>Always</td>
</tr>
<tr>
<td><code>fee</code>, <code>sizeInBytes</code>, <code>isCoinbase</code>, etc.</td>
<td>Transaction metadata</td>
<td>Always</td>
</tr>
</tbody>
</table>
<h4 id="child-records-index-1">Child Records (Index 1+)</h4>
<p>Contain UTXO batches with minimal metadata:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>utxos</code></td>
<td>Next 20,000 UTXO entries</td>
<td>Always</td>
</tr>
<tr>
<td><code>recordUtxos</code></td>
<td>Number of non-nil UTXOs in THIS child record</td>
<td>Always</td>
</tr>
<tr>
<td><code>spentUtxos</code></td>
<td>Number of spent UTXOs in THIS child record</td>
<td>Always</td>
</tr>
<tr>
<td><code>deleteAtHeight</code></td>
<td>Cleanup trigger for this record</td>
<td>When set</td>
</tr>
<tr>
<td>Common metadata</td>
<td>Version, locktime, fee, isCoinbase, locked, conflicting</td>
<td>Always</td>
</tr>
</tbody>
</table>
<p><strong>Child Record DAH Management:</strong></p>
<ul>
<li>When master record's UTXOs all spent  <code>SetDAHForChildRecords()</code> sets DAH on all children</li>
<li>When master record unspentalready  <code>SetDAHForChildRecords()</code> with DAH=0 clears DAH on all children</li>
<li>Enables coordinated cleanup of entire transaction across all pagination records</li>
</ul>
<h4 id="pagination-example">Pagination Example</h4>
<p>Transaction with 45,000 outputs splits into 3 records:</p>
<div class="highlight"><pre><span></span><code>Master Record (key = hash(txID), index 0):

  - utxos[0:20000]        // First 20K UTXOs
  - totalUtxos = 45000
  - totalExtraRecs = 2
  - recordUtxos = 20000   // Non-nil in this record
  - spentUtxos = 0
  - spentExtraRecs = 0
  - Full tx data or external=true
  - All metadata fields

Child Record 1 (key = hash(txID+1), index 1):

  - utxos[20000:40000]    // Second 20K UTXOs
  - recordUtxos = 20000
  - spentUtxos = 0
  - Common metadata only

Child Record 2 (key = hash(txID+2), index 2):

  - utxos[40000:45000]    // Final 5K UTXOs
  - recordUtxos = 5000
  - spentUtxos = 0
  - Common metadata only
</code></pre></div>
<p><strong>Retrieval Process</strong> (from <code>stores/utxo/aerospike/get.go</code>):</p>
<ol>
<li>Fetch master record by transaction ID</li>
<li>Read <code>totalExtraRecs</code> to determine number of child records</li>
<li>Loop from index 1 to <code>totalExtraRecs</code>, fetching each child record</li>
<li>Combine UTXOs from all records into single <code>spendingDatas</code> array</li>
<li>Calculate correct offset: <code>baseOffset = recordNum * utxoBatchSize</code></li>
</ol>
<h3 id="external-blob-storage">External Blob Storage</h3>
<p>Large transactions exceeding Aerospike size limits are stored in external blob storage (S3, filesystem, or HTTP-accessible storage).</p>
<h4 id="trigger-conditions">Trigger Conditions</h4>
<p>External storage used when:</p>
<ul>
<li>Transaction size &gt; <code>MaxTxSizeInStoreInBytes</code> (typically 1MB)</li>
<li>Transaction has &gt;20,000 outputs (automatic with pagination)</li>
<li>Configuration forces externalization: <code>ExternalizeAllTransactions=true</code></li>
</ul>
<h4 id="file-types">File Types</h4>
<p>Two file type options for external storage:</p>
<table>
<thead>
<tr>
<th>File Type</th>
<th>Extension</th>
<th>Contents</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FileTypeTx</code></td>
<td><code>.tx</code></td>
<td>Complete serialized transaction (inputs + outputs)</td>
<td>Full transactions with &lt;100K outputs</td>
</tr>
<tr>
<td><code>FileTypeOutputs</code></td>
<td><code>.outputs</code></td>
<td>UTXO wrapper containing only outputs</td>
<td>Partial transactions, very large output sets, or when inputs not available</td>
</tr>
</tbody>
</table>
<p><strong>UTXOWrapper Format</strong> (FileTypeOutputs):</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">UTXOWrapper</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">TxID</span><span class="w">     </span><span class="nx">chainhash</span><span class="p">.</span><span class="nx">Hash</span>
<span class="w">    </span><span class="nx">Height</span><span class="w">   </span><span class="kt">uint32</span>
<span class="w">    </span><span class="nx">Coinbase</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">    </span><span class="nx">UTXOs</span><span class="w">    </span><span class="p">[]</span><span class="o">*</span><span class="nx">UTXO</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">UTXO</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Index</span><span class="w">  </span><span class="kt">uint32</span><span class="w">      </span><span class="c1">// Output index</span>
<span class="w">    </span><span class="nx">Value</span><span class="w">  </span><span class="kt">uint64</span><span class="w">      </span><span class="c1">// Satoshis</span>
<span class="w">    </span><span class="nx">Script</span><span class="w"> </span><span class="p">[]</span><span class="kt">byte</span><span class="w">      </span><span class="c1">// Locking script</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="storage-flow">Storage Flow</h4>
<p><strong>Normal Transactions</strong> (from <code>stores/utxo/aerospike/create.go:sendStoreBatch()</code>):</p>
<ol>
<li>Calculate transaction extended size</li>
<li>
<p>If size  1MB and 20K outputs:</p>
<ul>
<li>Store transaction data in Aerospike <code>inputs</code> and <code>outputs</code> bins</li>
<li>Store UTXOs in <code>utxos</code> bin</li>
<li>Set <code>external=false</code></li>
<li>
<p>If size &gt; 1MB:</p>
</li>
<li>
<p>Write transaction to blob storage as <code>.tx</code> file</p>
</li>
<li>Store only metadata and UTXOs in Aerospike</li>
<li>Set <code>external=true</code> flag</li>
</ul>
</li>
</ol>
<p><strong>Partial Transactions</strong> (outputs only):</p>
<ol>
<li>Create <code>UTXOWrapper</code> with non-nil outputs</li>
<li>Serialize wrapper to bytes</li>
<li>Write to blob storage as <code>.outputs</code> file</li>
<li>Store metadata and UTXO hashes in Aerospike</li>
<li>Set <code>external=true</code> flag</li>
</ol>
<h4 id="retrieval-from-external-storage">Retrieval from External Storage</h4>
<p><strong>Full Transaction Retrieval</strong> (from <code>stores/utxo/aerospike/get.go:GetTxFromExternalStore()</code>):</p>
<ol>
<li>Check <code>external</code> flag in Aerospike record</li>
<li>
<p>If true, attempt to fetch from blob storage:</p>
<ul>
<li>Try <code>FileTypeTx</code> first (<code>.tx</code> file)</li>
<li>If not found, try <code>FileTypeOutputs</code> (<code>.outputs</code> file)</li>
<li>Deserialize transaction or outputs</li>
<li>Combine with metadata from Aerospike</li>
<li>Return complete transaction data</li>
</ul>
</li>
</ol>
<p><strong>Caching Strategy:</strong></p>
<ul>
<li>External transaction cache (<code>externalTxCache</code>) caches frequently accessed transactions</li>
<li>
<p>Cache decisions based on number of active outputs:</p>
<ul>
<li><code>numberOfActiveOutputs &lt; 2</code>  Do not cache (single-use)</li>
<li><code>numberOfActiveOutputs  2</code>  Cache for reuse</li>
<li>OP_RETURN outputs with 0 satoshis excluded from cache size calculation</li>
</ul>
</li>
</ul>
<h4 id="external-dah-management">External DAH Management</h4>
<p>When transactions stored externally require cleanup:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Set DAH in blob storage metadata</span>
<span class="nx">setDAHExternalTransaction</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">txID</span><span class="p">,</span><span class="w"> </span><span class="nx">deleteAtHeight</span><span class="p">)</span>

<span class="c1">// Process:</span>
<span class="c1">// 1. Try to set DAH on .tx file</span>
<span class="c1">// 2. If not found, try .outputs file</span>
<span class="c1">// 3. Update blob storage metadata with DAH value</span>
<span class="c1">// 4. Blob storage system handles deletion at specified height</span>
</code></pre></div>
<h3 id="binary-encoding-in-aerospike">Binary Encoding in Aerospike</h3>
<p>Transaction components are stored as binary-encoded Aerospike bins for space efficiency.</p>
<h4 id="input-encoding-extended-format">Input Encoding (Extended Format)</h4>
<p>Each input stored with extended data for previous output information:</p>
<div class="highlight"><pre><span></span><code>[Standard Input Data]
   PreviousTxID (32 bytes)
   PreviousTxOutIndex (4 bytes, little-endian uint32)
   ScriptSig (variable length with VarInt prefix)
   Sequence (4 bytes, little-endian uint32)

[Extended Data] (appended to standard input)
   PreviousTxSatoshis (8 bytes, little-endian uint64)
   PreviousTxScript (variable length with VarInt prefix)
      If nil: Single 0x00 byte
      If present: VarInt(length) + script bytes
</code></pre></div>
<p><strong>Purpose</strong>: Extended format enables validation without additional database lookups for previous output data.</p>
<h4 id="output-encoding">Output Encoding</h4>
<p>Standard Bitcoin output serialization:</p>
<div class="highlight"><pre><span></span><code> Satoshis (8 bytes, little-endian uint64)
 LockingScript (variable length with VarInt prefix)
    VarInt(scriptLength)
    Script bytes
</code></pre></div>
<p><strong>Storage Optimization</strong>:</p>
<ul>
<li>Nil outputs stored as <code>nil</code> in arrays (not serialized)</li>
<li>OP_RETURN outputs with 0 satoshis may be excluded from external storage</li>
<li><code>ShouldStoreOutputAsUTXO()</code> determines which outputs get UTXO entries</li>
</ul>
<h4 id="utxo-array-encoding">UTXO Array Encoding</h4>
<p>The <code>utxos</code> bin contains an array of variable-length byte arrays:</p>
<div class="highlight"><pre><span></span><code>utxos = [utxo0, utxo1, utxo2, ...]

Each utxo entry:
   32 bytes  Unspent UTXO (hash only)
   68 bytes  Spent UTXO (hash + spending data)
                or Frozen UTXO (hash + 0xFF pattern)
</code></pre></div>
<p><strong>Array Indexing</strong>:</p>
<ul>
<li>Direct correspondence to transaction output indices</li>
<li><code>utxos[i]</code> corresponds to transaction output <code>i</code></li>
<li>Spending lookup: <code>spend.Vout % utxoBatchSize</code> for offset within record</li>
</ul>
<h3 id="key-source-calculation">Key Source Calculation</h3>
<p>Aerospike keys are calculated to enable efficient lookups and pagination:</p>
<h4 id="master-record-key">Master Record Key</h4>
<div class="highlight"><pre><span></span><code><span class="c1">// Direct transaction ID used as key</span>
<span class="nx">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">aerospike</span><span class="p">.</span><span class="nx">NewKey</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">,</span><span class="w"> </span><span class="nx">txID</span><span class="p">[:])</span>
</code></pre></div>
<h4 id="child-record-keys">Child Record Keys</h4>
<div class="highlight"><pre><span></span><code><span class="c1">// Calculated using utility function</span>
<span class="nx">keySource</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">uaerospike</span><span class="p">.</span><span class="nx">CalculateKeySourceInternal</span><span class="p">(</span><span class="nx">txID</span><span class="p">,</span><span class="w"> </span><span class="nx">childIndex</span><span class="p">)</span>
<span class="nx">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">aerospike</span><span class="p">.</span><span class="nx">NewKey</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">,</span><span class="w"> </span><span class="nx">keySource</span><span class="p">)</span>

<span class="c1">// Where childIndex = 1, 2, 3... for pagination records</span>
</code></pre></div>
<h4 id="spend-lookup-keys">Spend Lookup Keys</h4>
<div class="highlight"><pre><span></span><code><span class="c1">// Includes output index for efficient spend checks</span>
<span class="nx">keySource</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">uaerospike</span><span class="p">.</span><span class="nx">CalculateKeySource</span><span class="p">(</span><span class="nx">txID</span><span class="p">,</span><span class="w"> </span><span class="nx">vout</span><span class="p">,</span><span class="w"> </span><span class="nx">utxoBatchSize</span><span class="p">)</span>
<span class="nx">key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">aerospike</span><span class="p">.</span><span class="nx">NewKey</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span><span class="w"> </span><span class="nx">setName</span><span class="p">,</span><span class="w"> </span><span class="nx">keySource</span><span class="p">)</span>

<span class="c1">// Maps vout to correct pagination record automatically</span>
</code></pre></div>
<h3 id="storage-size-limits">Storage Size Limits</h3>
<table>
<thead>
<tr>
<th>Limit</th>
<th>Value</th>
<th>Enforcement</th>
</tr>
</thead>
<tbody>
<tr>
<td>Max transaction size in Aerospike</td>
<td>1MB</td>
<td><code>MaxTxSizeInStoreInBytes</code></td>
</tr>
<tr>
<td>UTXOs per Aerospike record</td>
<td>20,000</td>
<td><code>utxoBatchSize</code> setting</td>
</tr>
<tr>
<td>Aerospike record size limit</td>
<td>~1MB</td>
<td>Database constraint</td>
</tr>
<tr>
<td>External blob size</td>
<td>Unlimited</td>
<td>Blob storage dependent</td>
</tr>
</tbody>
</table>
<p><strong>Automatic Handling</strong>:</p>
<ul>
<li>Transactions exceeding limits automatically use external storage</li>
<li>Pagination automatically triggered at 20K output threshold</li>
<li><code>RECORD_TOO_BIG</code> error triggers retry with external storage</li>
<li>No application-level size restrictions on individual transactions</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2025 BSV Blockchain Org.
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/bsv-blockchain/teranode" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.instant", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>